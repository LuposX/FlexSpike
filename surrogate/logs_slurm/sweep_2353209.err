/home/ka/ka_itec/ka_rh5993/.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/home/ka/ka_itec/ka_rh5993/.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
2025-11-28 17:29:56,979 INFO: Loading dataset from ./data/dataset.ds
2025-11-28 17:29:57,189 INFO: Using accelerator=cpu
2025-11-28 17:29:57,189 INFO: === Starting run 1/4 with seed 42 ===
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
wandb: Currently logged in as: lupos to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run 9sflmouq
wandb: Tracking run with wandb version 0.22.2
wandb: Run data is saved locally in /scratch/ka_rh5993/wandb_logs/wandb/run-20251128_172957-9sflmouq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run SRC_HypOpt_run1
wandb: â­ï¸ View project at https://wandb.ai/lupos/surrogate-confidence
wandb: ðŸš€ View run at https://wandb.ai/lupos/surrogate-confidence/runs/9sflmouq
/home/ka/ka_itec/ka_rh5993/.local/lib/python3.12/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:751: Checkpoint directory /pfs/data6/home/ka/ka_itec/ka_rh5993/SpikeSynth/surrogate/models/SRNN exists and is not empty.

  | Name             | Type       | Params | Mode 
--------------------------------------------------------
0 | norm             | LayerNorm  | 14     | train
1 | lif_layers       | ModuleList | 199 K  | train
2 | leaky_linears    | ModuleList | 0      | train
3 | temp_skip_projs  | ModuleList | 0      | train
4 | layer_skip_projs | ModuleList | 0      | train
5 | layer_bntt       | ModuleList | 0      | train
6 | layer_norms      | ModuleList | 0      | train
7 | output_layer     | Linear     | 257    | train
--------------------------------------------------------
199 K     Trainable params
0         Non-trainable params
199 K     Total params
0.799     Total estimated model params size (MB)
16        Modules in train mode
0         Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
Metric val_loss improved. New best score: 0.288
Metric val_loss improved by 0.084 >= min_delta = 0.0001. New best score: 0.204
Metric val_loss improved by 0.026 >= min_delta = 0.0001. New best score: 0.178
Metric val_loss improved by 0.008 >= min_delta = 0.0001. New best score: 0.171
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.170
Metric val_loss improved by 0.005 >= min_delta = 0.0001. New best score: 0.165
Metric val_loss improved by 0.002 >= min_delta = 0.0001. New best score: 0.163
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.163
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.163
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.162
Metric val_loss improved by 0.002 >= min_delta = 0.0001. New best score: 0.161
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.160
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.159
Metric val_loss improved by 0.002 >= min_delta = 0.0001. New best score: 0.158
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.157
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.157
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.156
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.155
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.155
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.154
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.153
Monitored metric val_loss did not improve in the last 50 records. Best score: 0.153. Signaling Trainer to stop.
2025-11-29 02:18:56,192 INFO: Starting test for run 1 using best checkpoint
Restoring states from the checkpoint path at /pfs/data6/home/ka/ka_itec/ka_rh5993/SpikeSynth/surrogate/models/SRNN/SRC_HypOpt-runrun_idx=0-epoch=99-val_loss=0.15.ckpt
Loaded model weights from the checkpoint at /pfs/data6/home/ka/ka_itec/ka_rh5993/SpikeSynth/surrogate/models/SRNN/SRC_HypOpt-runrun_idx=0-epoch=99-val_loss=0.15.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
wandb: updating run metadata
wandb: uploading console lines 43-55
wandb: 
wandb: Run history:
wandb:                    epoch â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:   grad_mean/lif_layers.0 â–â–â–â–â–â–‚â–‚â–†â–â–â–‚â–…â–‚â–ˆâ–ƒâ–ƒâ–â–‚â–‚â–â–â–â–â–‚â–‚â–‚â–‚â–ˆâ–‚â–…â–‚â–â–‚â–‚â–‚â–‚â–â–ƒâ–â–‚
wandb:   grad_mean/lif_layers.1 â–‚â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–â–‚â–â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–ˆâ–â–â–â–â–â–â–â–â–â–â–
wandb:   grad_mean/lif_layers.2 â–ˆâ–â–‚â–â–â–â–‚â–â–â–ƒâ–â–â–‚â–â–‚â–„â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–„â–‚â–‚â–ƒâ–ƒâ–‚â–‚â–â–â–
wandb:   grad_mean/lif_layers.3 â–ƒâ–â–‚â–â–â–â–â–â–â–‚â–â–â–â–â–â–‚â–†â–‚â–â–â–‚â–â–â–â–â–â–â–â–‚â–‚â–‚â–â–ˆâ–‚â–‚â–ƒâ–‚â–‚â–â–
wandb:   grad_mean/output_layer â–â–â–â–â–â–‚â–â–â–â–â–‚â–â–â–‚â–‚â–â–â–‚â–‚â–â–â–â–â–â–â–â–â–ˆâ–ƒâ–â–â–â–â–â–â–‚â–‚â–‚â–‚â–
wandb:                       lr â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–†â–†â–…â–…â–…â–…â–…â–…â–„â–„â–„â–ƒâ–ƒâ–‚â–‚â–‚â–â–â–
wandb: spikes/train_avg_layer_0 â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒ
wandb: spikes/train_avg_layer_1 â–ˆâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–â–â–â–‚â–ƒâ–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒ
wandb: spikes/train_avg_layer_2 â–‚â–â–‚â–ƒâ–„â–ˆâ–ˆâ–ˆâ–‡â–ˆâ–†â–†â–†â–†â–†â–â–‚â–â–ƒâ–‚â–„â–„â–‚â–ƒâ–‚â–…â–„â–‚â–ƒâ–„â–ƒâ–ƒâ–„â–„â–„â–…â–…â–…â–„â–„
wandb:                       +8 ...
wandb: 
wandb: Run summary:
wandb:                    epoch 145
wandb:   grad_mean/lif_layers.0 0.00088
wandb:   grad_mean/lif_layers.1 0.0
wandb:   grad_mean/lif_layers.2 0.0
wandb:   grad_mean/lif_layers.3 0.0
wandb:   grad_mean/output_layer 0.00856
wandb:                       lr 0.02105
wandb: spikes/train_avg_layer_0 0.03283
wandb: spikes/train_avg_layer_1 0.02946
wandb: spikes/train_avg_layer_2 0.06695
wandb:                       +8 ...
wandb: 
wandb: ðŸš€ View run SRC_HypOpt_run1 at: https://wandb.ai/lupos/surrogate-confidence/runs/9sflmouq
wandb: â­ï¸ View project at: https://wandb.ai/lupos/surrogate-confidence
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: /scratch/ka_rh5993/wandb_logs/wandb/run-20251128_172957-9sflmouq/logs
2025-11-29 02:19:01,349 INFO: Run 1 finished. Best checkpoint: /pfs/data6/home/ka/ka_itec/ka_rh5993/SpikeSynth/surrogate/models/SRNN/SRC_HypOpt-runrun_idx=0-epoch=99-val_loss=0.15.ckpt
2025-11-29 02:19:01,350 INFO: === Starting run 2/4 with seed 43 ===
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
wandb: setting up run qeuvq8zx
wandb: Tracking run with wandb version 0.22.2
wandb: Run data is saved locally in /scratch/ka_rh5993/wandb_logs/wandb/run-20251129_021901-qeuvq8zx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run SRC_HypOpt_run2
wandb: â­ï¸ View project at https://wandb.ai/lupos/surrogate-confidence
wandb: ðŸš€ View run at https://wandb.ai/lupos/surrogate-confidence/runs/qeuvq8zx
/home/ka/ka_itec/ka_rh5993/.local/lib/python3.12/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:751: Checkpoint directory /pfs/data6/home/ka/ka_itec/ka_rh5993/SpikeSynth/surrogate/models/SRNN exists and is not empty.

  | Name             | Type       | Params | Mode 
--------------------------------------------------------
0 | norm             | LayerNorm  | 14     | train
1 | lif_layers       | ModuleList | 199 K  | train
2 | leaky_linears    | ModuleList | 0      | train
3 | temp_skip_projs  | ModuleList | 0      | train
4 | layer_skip_projs | ModuleList | 0      | train
5 | layer_bntt       | ModuleList | 0      | train
6 | layer_norms      | ModuleList | 0      | train
7 | output_layer     | Linear     | 257    | train
--------------------------------------------------------
199 K     Trainable params
0         Non-trainable params
199 K     Total params
0.799     Total estimated model params size (MB)
16        Modules in train mode
0         Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
Metric val_loss improved. New best score: 0.257
Metric val_loss improved by 0.075 >= min_delta = 0.0001. New best score: 0.182
Metric val_loss improved by 0.014 >= min_delta = 0.0001. New best score: 0.168
Metric val_loss improved by 0.003 >= min_delta = 0.0001. New best score: 0.165
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.163
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.163
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.163
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.162
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.162
Metric val_loss improved by 0.002 >= min_delta = 0.0001. New best score: 0.160
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.159
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.158
Metric val_loss improved by 0.002 >= min_delta = 0.0001. New best score: 0.156
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.155
Metric val_loss improved by 0.002 >= min_delta = 0.0001. New best score: 0.154
Metric val_loss improved by 0.003 >= min_delta = 0.0001. New best score: 0.150
Monitored metric val_loss did not improve in the last 50 records. Best score: 0.150. Signaling Trainer to stop.
2025-11-29 07:38:23,857 INFO: Starting test for run 2 using best checkpoint
Restoring states from the checkpoint path at /pfs/data6/home/ka/ka_itec/ka_rh5993/SpikeSynth/surrogate/models/SRNN/SRC_HypOpt-runrun_idx=0-epoch=47-val_loss=0.15.ckpt
Loaded model weights from the checkpoint at /pfs/data6/home/ka/ka_itec/ka_rh5993/SpikeSynth/surrogate/models/SRNN/SRC_HypOpt-runrun_idx=0-epoch=47-val_loss=0.15.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
wandb: updating run metadata
wandb: uploading console lines 38-50
wandb: 
wandb: Run history:
wandb:                    epoch â–â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:   grad_mean/lif_layers.0 â–‚â–â–‚â–ƒâ–ƒâ–†â–‡â–‚â–‚â–‚â–‚â–â–â–â–â–‚â–‚â–â–‚â–‚â–ˆâ–ƒâ–‡â–‚â–‚â–â–â–‚â–â–â–‚â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚
wandb:   grad_mean/lif_layers.1 â–‚â–â–â–â–â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:   grad_mean/lif_layers.2 â–â–â–â–â–â–â–â–‚â–â–‚â–â–‚â–ˆâ–†â–ƒâ–‚â–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–‚â–ƒâ–‚â–‚â–‚â–ƒâ–‚â–‚â–ƒâ–‚â–„â–†â–„â–‚
wandb:   grad_mean/lif_layers.3 â–‡â–â–â–â–â–â–‚â–ƒâ–â–â–‚â–â–â–‚â–‚â–‚â–‚â–‚â–ƒâ–ˆâ–‡â–‡â–„â–ƒâ–ƒâ–ƒâ–„â–ƒâ–‚â–‚â–‚â–‚â–‚â–ƒâ–„â–„â–‚â–‚â–‚â–‚
wandb:   grad_mean/output_layer â–‡â–‡â–â–â–â–…â–†â–„â–ƒâ–‚â–‚â–â–‚â–â–ƒâ–‚â–‚â–†â–‚â–‚â–ƒâ–ˆâ–†â–ƒâ–‚â–…â–â–‚â–„â–‚â–„â–…â–â–‚â–‚â–„â–‚â–‡â–ƒâ–†
wandb:                       lr â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–†â–…â–…â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–
wandb: spikes/train_avg_layer_0 â–ˆâ–ˆâ–†â–‡â–‡â–†â–„â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–„â–„â–…
wandb: spikes/train_avg_layer_1 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒ
wandb: spikes/train_avg_layer_2 â–„â–„â–„â–„â–„â–„â–„â–…â–ˆâ–…â–†â–†â–ƒâ–„â–„â–„â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚
wandb:                       +8 ...
wandb: 
wandb: Run summary:
wandb:                    epoch 98
wandb:   grad_mean/lif_layers.0 0.00209
wandb:   grad_mean/lif_layers.1 1e-05
wandb:   grad_mean/lif_layers.2 0.0
wandb:   grad_mean/lif_layers.3 0.0
wandb:   grad_mean/output_layer 0.01168
wandb:                       lr 0.03036
wandb: spikes/train_avg_layer_0 0.04314
wandb: spikes/train_avg_layer_1 0.02504
wandb: spikes/train_avg_layer_2 0.03383
wandb:                       +8 ...
wandb: 
wandb: ðŸš€ View run SRC_HypOpt_run2 at: https://wandb.ai/lupos/surrogate-confidence/runs/qeuvq8zx
wandb: â­ï¸ View project at: https://wandb.ai/lupos/surrogate-confidence
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: /scratch/ka_rh5993/wandb_logs/wandb/run-20251129_021901-qeuvq8zx/logs
2025-11-29 07:38:28,766 INFO: Run 2 finished. Best checkpoint: /pfs/data6/home/ka/ka_itec/ka_rh5993/SpikeSynth/surrogate/models/SRNN/SRC_HypOpt-runrun_idx=0-epoch=47-val_loss=0.15.ckpt
2025-11-29 07:38:28,766 INFO: === Starting run 3/4 with seed 44 ===
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
wandb: setting up run l97og1ln
wandb: Tracking run with wandb version 0.22.2
wandb: Run data is saved locally in /scratch/ka_rh5993/wandb_logs/wandb/run-20251129_074039-l97og1ln
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run SRC_HypOpt_run3
wandb: â­ï¸ View project at https://wandb.ai/lupos/surrogate-confidence
wandb: ðŸš€ View run at https://wandb.ai/lupos/surrogate-confidence/runs/l97og1ln
/home/ka/ka_itec/ka_rh5993/.local/lib/python3.12/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:751: Checkpoint directory /pfs/data6/home/ka/ka_itec/ka_rh5993/SpikeSynth/surrogate/models/SRNN exists and is not empty.

  | Name             | Type       | Params | Mode 
--------------------------------------------------------
0 | norm             | LayerNorm  | 14     | train
1 | lif_layers       | ModuleList | 199 K  | train
2 | leaky_linears    | ModuleList | 0      | train
3 | temp_skip_projs  | ModuleList | 0      | train
4 | layer_skip_projs | ModuleList | 0      | train
5 | layer_bntt       | ModuleList | 0      | train
6 | layer_norms      | ModuleList | 0      | train
7 | output_layer     | Linear     | 257    | train
--------------------------------------------------------
199 K     Trainable params
0         Non-trainable params
199 K     Total params
0.799     Total estimated model params size (MB)
16        Modules in train mode
0         Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
Metric val_loss improved. New best score: 0.290
Metric val_loss improved by 0.108 >= min_delta = 0.0001. New best score: 0.182
Metric val_loss improved by 0.015 >= min_delta = 0.0001. New best score: 0.167
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.166
Metric val_loss improved by 0.002 >= min_delta = 0.0001. New best score: 0.164
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.163
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.162
Metric val_loss improved by 0.002 >= min_delta = 0.0001. New best score: 0.160
Metric val_loss improved by 0.003 >= min_delta = 0.0001. New best score: 0.157
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.156
Metric val_loss improved by 0.002 >= min_delta = 0.0001. New best score: 0.154
Metric val_loss improved by 0.001 >= min_delta = 0.0001. New best score: 0.153
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.152
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.152
Metric val_loss improved by 0.000 >= min_delta = 0.0001. New best score: 0.152
slurmstepd: error: *** JOB 2353209 ON uc3n003 CANCELLED AT 2025-11-29T13:29:33 DUE TO TIME LIMIT ***
