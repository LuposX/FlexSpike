method: random
name: "SweepRC"
metric:
  name: val_loss
  goal: minimize
parameters:
  lr:
    distribution: log_uniform_values
    min: 1e-6
    max: 5e-2
  num_hidden:
    values: [4, 16, 64, 128, 256]
  beta:
    value: 0 # No effect for SRC instead chnage alpha
  surrogate_gradient:
    value: "atan"
  neuron_type:
    value: "SRC"
  dropout:
    value: 0
  batch_size:
    value: 2048
  optimizer_class:
    value: "AdamW"
  num_hidden_layers:
    values: [2, 4, 6, 8, 16]
  temporal_skip:
    value: -1
  use_bntt:
    value: False
  use_layernorm:
    value: False
  bntt_time_steps:
    value: 100
  layer_skip:
    value: 0
  scheduler_class:
    value: "cosine"
  scheduler_kwargs:
    value: ""
  data_path:
    value: "./data/small_dataset.ds"
  epochs:
    value: 50
  loss_fn:
    value: "mse"
  loss_kwargs:
    value: ""
  # SRC-specific hyperparameters
  alpha:
    value: 0.9
  rho:
    value: 3 
  r:
    value: 2
  rs:
    value: -7
  z:
    value: 0.0
  zhyp_s:
    value: 0.9
  zdep_s:
    value: 0.0
  bh_init:
    values: [-6.0, -4.0, -2.0]            # prevents spike collapse
  bh_max:
    value: -4.0
  detach_rec:
    values: [True, False]
  relu_bypass:
    values: [True, False]

run_cap: 100

early_terminate:
  type: hyperband
  s: 3
  eta: 3
  max_iter: 50
