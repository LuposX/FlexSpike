method: random
name: "SweepRC"
metric:
  name: val_loss
  goal: minimize
parameters:
  lr:
    distribution: log_uniform_values
    min: 1e-6
    max: 1e-3
  num_hidden:
    values: [4, 16, 64, 128]
  beta:
    value: 0 # No effect for SRC instead chnage alpha
  surrogate_gradient:
    value: "atan"
  neuron_type:
    value: "SRC"
  dropout:
    value: 0
  batch_size:
    value: 2048
  optimizer_class:
    value: "AdamW"
  num_hidden_layers:
    values: [2, 4, 8, 16]
  temporal_skip:
    value: -1
  use_bntt:
    value: False
  use_layernorm:
    value: False
  bntt_time_steps:
    value: 100
  layer_skip:
    value: 0
  scheduler_class:
    value: "cosine"
  scheduler_kwargs:
    value: ""
  data_path:
    value: "./data/small_dataset.ds"
  epochs:
    value: 40
  # SRC-specific hyperparameters
  alpha:
    values: [0.85, 0.9, 0.95]        # moderate integrator decay
  rho:
    values: [1.0, 2.0, 3.0]         # prevents tanh saturation
  r:
    values: [2.0, 4.0]              # recurrence weight
  rs:
    values: [-5.0, -3.0]            # avoids dead spikes
  z:
    values: [0.0, 0.1, 0.2]
  zhyp_s:
    values: [0.8, 0.9, 1.0]
  zdep_s:
    values: [0.0, 0.1, 0.2]
  bh_init:
    values: [-6.0, -5.0]            # prevents spike collapse
  bh_max:
    values: [-4.0, -3.0]
  detach_rec:
    values: [True, False]
  relu_bypass:
    values: [True, False]

run_cap: 200

early_terminate:
  type: hyperband
  s: 2
  eta: 3
  max_iter: 40
